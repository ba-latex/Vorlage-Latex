%! LaTeX Vorlage
%! Der Großteil der Vorlage liegt in "vorlage_commont.tex".
%! In dieser Datei befinden sich ausschließlich Anweisungen,
%! welche sich zwischen Light- und Full-Version unterscheiden.
\input{light/vorlage_common.tex}

\ProvidesPackage{metadaten}
\usepackage{metadaten}

\usepackage[backend=biber, style=authortitle, isbn=false]{biblatex}

%Inhaltsverzeichnis in Inhaltsverzeichnis listen
\setuptoc{toc}{totoc}

%! PageBreaks nach jeder Section
\let\oldsection\section
\renewcommand\section{\clearpage\oldsection}

%! PDF-Metadaten
\hypersetup{pdftitle={\titel}}
\hypersetup{pdfsubject={\kurzbeschreibung}}
\hypersetup{pdfauthor={\autoren}}

%! Formatierung des Literaturverzeichnis
\renewcaptionname{ngerman}{\refname}{Quellenverzeichnis}
\DeclareFieldFormat{url}{In: \url{#1}}
\DeclareFieldFormat{urldate}{\space\mkbibparens{#1}}
\urlstyle{same}
 \DeclareNameFormat{author}{%
      \nameparts{#1}%
      \usebibmacro{name:family-given}
        {\namepartfamily}
        {\namepartgiven}
        {\namepartprefix}
        {\namepartsuffix}%
}
\DeclareFieldFormat{title}{#1}
\renewcommand{\multinamedelim}{\addsemicolon\space}
\renewcommand{\finalnamedelim}{\addsemicolon\space}
\renewcommand{\labelnamepunct}{\addcolon\space}
\renewcommand*{\finentrypunct}{}

\setlength\bibitemsep{\baselineskip}
\setlength\bibhang{0pt}

%! Formatierung der Fußnotenzitate / Literaturverzeichnis
\renewcommand*{\newunitpunct}{\addcomma\space} 

%? Normales Zitat...
\DeclareCiteCommand{\zitat}[\mkbibfootnote]
  {\usebibmacro{prenote}}
  {\usebibmacro{citeindex}
   \setunit{\addnbspace}
   \bibhyperref{\printnames{labelname}}
   \setunit{\labelnamepunct}
   \newunit
   \printfield{location}
   \newunit
   \printfield{year}
   \newunit
   \printfield{pages}
   }
  {\addsemicolon\space}
  {\usebibmacro{postnote}}

%? Online Zitat
\DeclareCiteCommand{\onlinezitat}[\mkbibfootnote]
  {\usebibmacro{prenote}}
  {\usebibmacro{citeindex}
   \setunit{\addnbspace}
   online:
   \bibhyperref{\printnames{labelname}}
   \setunit{\labelnamepunct}
   \newunit
   \printfield{year}
   \printtext{(}\printfield{urlday}\printtext{.}\printfield{urlmonth}\printtext{.}\printfield{urlyear}\printtext{)}}
  {\addsemicolon\space}
  {\usebibmacro{postnote}}
\renewcommand{\bibfootnotewrapper}[1]{\bibsentence#1}

\DeclareMultiCiteCommand{\zitate}[\mkbibfootnote]{\footpartcite}{\addsemicolon\space}
\addbibresource{literatur.bib}


\usepackage{xpatch}
\xapptocmd\appendix{%
  \useappendixtocs
  \listofatocs
  \addcontentsline{toc}{section}{Anhangverzeichnis}
  \newpage
  \pagenumbering{gobble}
  \pagestyle{scrheadings} 
  \clearmainofpairofpagestyles 
  \clearplainofpairofpagestyles
  \rohead{\textnormal{Anhang~\arabic{section}}}
  \lohead{\textnormal{\currentname}}
  \lofoot{} 
  \cofoot{} 
  \rofoot{}
}{}{}
